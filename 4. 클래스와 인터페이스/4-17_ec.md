# 변경 가능성을 최소화하라

불변 클래스란 간단히 말해 그 인스턴스의 내부 값을 수정할 수 없는 클래스다. (String, Integer, BigInterger, ...)

불변 클래스는 설계하고 구현하기 쉬우며 오류가 생길 여지도 적고 안전하다.

다음 다섯가지 규칙을 따르면 된다.

1. 객체의 상태를 변경하는 메서드를 제공하지 않는다.
2. 클래스를 확장할 수 없도록 한다. (final, private 생성자 + static 팩터리 메서드)
3. 모든 필드를 final로 선언한다.
4. 모든 필드를 private로 선언한다.
5. 자신 이외는 가변 컴포넌트에 접근할 수 없도록 한다. 클래스에 가변 객체가 있다면 클라이언트에서 그 객체의 참조를 얻을 수 없도록 해야 한다.

### 장점
1. 불변 객체는 근본적으로 스레드 안전하여 따로 동기화할 필요가 없다. 또한 불변 객체는 안심하고 공유할 수 있다.
2. 불변 객체는 그 자체로 실패 원자성을 제공한다. (메서드에서 예외가 발생하더라도 그 객체는 호출 전과 같은 상태를 유지한다)
3. 불변 객체는 자유롭게 공유할 수 있음은 물론, 불변 객체끼리 내부 데이터를 공유할 수 있다.

### 단점
1. 값이 다르면 반드시 독립된 객체로 만들어야 한다. (성능 저하)

### 정리
- 클래스는 꼭 필요한 경우가 아니라면 setter를 만들지 않고 불변으로 만든다.
- 불변으로 만들 수 없는 클래스라도 변경할 수 있는 부분은 최소한으로 줄여야한다. (private final)
- 생성자는 초기화가 완벽히 끝난 상태의 객체를 반환해야 한다.
